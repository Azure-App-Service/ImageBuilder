parameters:
  ascName: AppSvcDevACR
  acrName: appsvcdevacr.azurecr.io

steps:
- script: |
    if [ "$(InitialChecks)" != "true" ]
    then
      echo "Invalid configuration."
      echo "Variable 'InitialChecks' needs to be 'true' to run this build."
      exit 1
    fi
  displayName: 'Validate pipeline run'

- task: Docker@1
  displayName: Container registry login
  inputs:
    command: login
    azureSubscriptionEndpoint: ${{ parameters.ascName }}
    azureContainerRegistry: ${{ parameters.acrName }}

- task: ShellScript@2
  displayName: 'Generate ASP .NET Core Docker Files'
  inputs:
    scriptPath: ./GenerateDockerFiles/dotnetcore/generateDockerfiles.sh
    args: $(System.ArtifactsDirectory) mcr.microsoft.com/oryx/dotnetcore 20190611.2 appsvc https://github.com/Azure-App-Service/dotnetcore.git dev $(System.DefaultWorkingDirectory)/Config/dotnetcoreversions.txt
